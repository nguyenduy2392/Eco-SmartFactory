<div class="card shadow-2 m-3 p-3 bg-white border-round">
  <div class="flex align-items-center justify-content-between">
    <h2>Nhật ký hệ thống</h2>
  </div>
  <div class="card">
    <p-accordion [activeIndex]="0" expandIcon="pi pi-search-plus" collapseIcon="pi pi-search-minus">
      <p-accordionTab header="Lọc dữ liệu">
        <div class="grid">
          <div class="col-4">
            <label class="block text-900 font-medium mb-3">Từ khóa tìm kiếm</label>
            <div class="flex">
              <input [(ngModel)]="filter.keyword" type="text" pInputText placeholder="Nhập từ khóa tìm kiếm"
                class="w-full" />
            </div>
          </div>

          <div class="col-4">
            <label class="block text-900 font-medium mb-3">Ngày hoạt động</label>
            <div class="flex">
              <label for="invoiceFromDate" class="py-3 pr-3 white-space-nowrap">Từ ngày: </label>
              <p-calendar class="w-full" appendTo="body" [(ngModel)]="filter.fromDate" />
              <label for="invoiceToDate" class="py-3 px-3 white-space-nowrap">đến ngày</label>
              <p-calendar class="w-full" appendTo="body" [(ngModel)]="filter.toDate" />
            </div>
          </div>
          <div class="col-2">
            <label class="block text-900 font-medium mb-3">Nhân viên</label>
            <div class="flex">
              <p-dropdown [(ngModel)]="filter.userId" class="w-100" [options]="users" [showClear]="true"
                placeholder="Tất cả nhân viên" [style]="{ width: '100%' }" optionLabel="name" optionValue="id" />
            </div>
          </div>
          <div class="col-2 flex">
            <div class="mr-3">
              <label class="block text-900 font-medium mb-3">&nbsp;</label>
              <p-button (onClick)="GetHistory()" icon="pi pi-search" label="Tìm kiếm" [outlined]="true"
                severity="primary">
              </p-button>
            </div>
          </div>

        </div>
      </p-accordionTab>
    </p-accordion>
  </div>

  <p-table #dt [value]="histories" [lazy]="true" sortMode="single" [scrollable]="true" scrollWidth="60rem"
    scrollDirection="horizontal" [paginator]="false" [loading]="isLoading"
    styleClass="p-datatable-gridlines p-datatable-sm" [tableStyle]="{ 'min-width': '75rem' }" [rowHover]="true"
    dataKey="id" selectionMode="single" loadingIcon="pi pi-cog pi-spin text-white">
    <ng-template pTemplate="header">
      <tr class="px-2">
        <th pSortableColumn="khmshdon" class="text-center" style="width: 10%">
          <span>Địa chỉ IP</span>
        </th>
        <th pSortableColumn="khhdon" class="text-center" style="width: 15%">
          <span>Thời gian</span>
        </th>
        <th pSortableColumn="khhdon" class="text-center" style="width: 15%">
          <span>Nhân viên</span>
        </th>
        <th pSortableColumn="khhdon" class="text-center" style="width: 70%">
          <span>Thao tác</span>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item>
      <tr>

        <td class="text-center">
          {{ item.ip }}
        </td>

        <td class="text-center">
          {{ item.logTime | formatDateTime}}
        </td>
        <td>
          <a href="javascript:;"><strong>{{ item.userFullName }}</strong></a>
        </td>
        <td>
          {{ item.action }}
        </td>

      </tr>
    </ng-template>
  </p-table>
  <div class="flex align-items-center justify-content-center sticky bottom-0 bg-white w-full z-1">
    <div>
      <p-button icon="pi pi-refresh" type="primary" [text]="true" />
    </div>
    <div class="flex-1">
      <p-paginator currentPageReportTemplate="{first} -> {last} trên tổng {totalRecords} bản ghi"
        [first]="(this.filter.page - 1) * this.filter.pageSize" [rows]="this.filter.pageSize" [totalRecords]="total"
        [rowsPerPageOptions]="[10, 20, 50, 200]" [showCurrentPageReport]="true" (onPageChange)="OnChangePage($event)" />
    </div>
  </div>
</div>